<!DOCTYPE html>
<html lang="sr">
<head>
  <meta charset="UTF-8" />
  <title>Igra Asocijacije - Hemija</title>
  <style>
    body {
  margin: 0;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #1b2735, #090a0f);
  color: #e0e6f1;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: flex-start;
  min-height: 100vh;
  padding: 20px 10px;
  transition: background 1s ease-in-out;
  position: relative;
}

.container {
  background: #1f2a44;
  padding: 30px 40px;
  border-radius: 16px;
  box-shadow: 0 8px 20px rgba(0, 77, 179, 0.4);
  max-width: 900px;
  width: 100%;
  text-align: center;
}

h1 {
  font-weight: 700;
  font-size: 2.4rem;
  margin-bottom: 15px;
  color: #b0c4ff;
  text-shadow: 0 0 8px #3a7bd5;
}

p {
  font-size: 1.2rem;
  margin-bottom: 25px;
  color: #a8baff;
}

table {
  border-collapse: separate;
  border-spacing: 12px 12px;
  margin: 20px auto 30px auto;
  width: 100%;
  table-layout: fixed;
}

td {
  background: #2a3a62;
  border-radius: 10px;
  height: 90px;
  font-size: 20px;
  font-weight: 700;
  text-align: center;
  color: transparent;
  position: relative;
  box-shadow: 0 2px 8px rgba(0, 0, 50, 0.7);
  user-select: none;
  cursor: default;
  transition: color 0.3s ease;
}

td > div.cover {
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, #3a7bd5, #00d2ff);
  border-radius: 10px;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: 800;
  font-size: 28px;
  color: white;
  cursor: pointer;
  user-select: none;
  transition: background 0.3s ease;
}
td > div.cover:hover {
  background: linear-gradient(135deg, #1c4dd4, #00a1ff);
}

input[type='text'] {
  width: 90%;
  max-width: 400px;
  padding: 12px 15px;
  font-size: 18px;
  border-radius: 8px;
  border: none;
  background-color: #182746;
  color: #cbd4f7;
  box-shadow: inset 0 0 5px #3a7bd5;
  margin: 12px auto;
  display: block;
  transition: box-shadow 0.3s ease;
}
input[type='text']:focus {
  outline: none;
  box-shadow: 0 0 8px #00a1ff;
  background-color: #1f2a44;
}

.check-button {
  padding: 12px 28px;
  font-size: 18px;
  background: linear-gradient(135deg, #3a7bd5, #00d2ff);
  color: #fff;
  border: none;
  border-radius: 12px;
  margin: 8px 12px;
  cursor: pointer;
  font-weight: 700;
  box-shadow: 0 5px 12px rgba(0, 210, 255, 0.7);
  transition: background 0.25s ease, box-shadow 0.25s ease;
  user-select: none;
}
.check-button:hover {
  background: linear-gradient(135deg, #1e5ac8, #00a4ff);
  box-shadow: 0 8px 20px rgba(0, 164, 255, 0.9);
}

#toast-container {
  position: fixed;
  top: 25px;
  right: 25px;
  z-index: 9999;
  max-width: 280px;
}

.toast {
  min-width: 250px;
  padding: 16px 24px;
  border-radius: 14px;
  font-weight: 700;
  color: white;
  box-shadow: 0 6px 16px rgba(0, 110, 255, 0.5);
  opacity: 0;
  animation: fadeInOut 3s forwards;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}
.toast-success { background-color: #4caf50; }
.toast-warning { background-color: #ffb300; color: black; }
.toast-error   { background-color: #e53935; }

@keyframes fadeInOut {
  0% {opacity: 0; transform: translateX(100%);}
  10%, 90% {opacity: 1; transform: translateX(0);}
  100% {opacity: 0; transform: translateX(100%);}
}

#timer {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #0057e7cc;
  padding: 12px 26px;
  font-size: 22px;
  font-weight: 700;
  border-radius: 14px;
  color: #cde2ff;
  user-select: none;
  z-index: 10000;
  font-family: monospace;
  box-shadow: 0 0 14px #007fffcc;
  text-shadow: 0 0 6px #00b3ffcc;
}

@keyframes fadeSlideUp {
  from { opacity: 0; transform: translateY(30px); }
  to { opacity: 1; transform: translateY(0); }
}

.modal {
  display: none;
  position: fixed;
  z-index: 10001;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background: rgba(0,0,50,0.85);
}

.modal-content {
  background: #1f2a44;
  margin: 12% auto;
  padding: 30px 40px;
  border-radius: 18px;
  width: 90%;
  max-width: 500px;
  text-align: center;
  color: #cde2ff;
  box-shadow: 0 8px 20px rgba(0,0,100,0.7);
}

.modal-content h2 {
  font-size: 2rem;
  margin-bottom: 16px;
}

.modal-content p {
  font-size: 1.4rem;
  margin-bottom: 28px;
}

.modal-content button {
  padding: 14px 28px;
  font-size: 18px;
  background: linear-gradient(135deg, #3a7bd5, #00d2ff);
  color: #fff;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  font-weight: 700;
  box-shadow: 0 5px 14px rgba(0, 210, 255, 0.7);
  transition: background 0.3s ease, box-shadow 0.3s ease;
}

.modal-content button:hover {
  background: linear-gradient(135deg, #1e5ac8, #00a4ff);
  box-shadow: 0 8px 20px rgba(0, 164, 255, 0.9);
}

.modal-content h3 {
  margin-top: 0;
  margin-bottom: 20px;
  color: #a3b8ff;
  font-weight: 700;
  text-shadow: 0 0 8px #3a7bd5;
}

#solutionsList {
  list-style-type: none;
  padding: 0;
  margin-bottom: 30px;
  font-size: 18px;
  color: #d4dbff;
  text-align: left;
}

#solutionsList li {
  background: #24335a;
  margin-bottom: 10px;
  padding: 12px 18px;
  border-radius: 14px;
  box-shadow: 0 4px 10px rgba(0, 123, 255, 0.6);
  font-weight: 600;
  display: flex;
  justify-content: space-between;
}

#solutionsList li strong {
  color: #85a1ff;
  min-width: 90px;
  text-shadow: 0 0 5px #3a7bd5;
}



  </style>
</head>
<body>
  <div class="container">
    <!--<h1>Hemijske Asocijacije</h1>-->
    <p>Rezultat: <span id="scoreDisplay">0</span> bodova</p>
    <table id="table"><tbody></tbody></table>

    <input type="text" id="keyA" placeholder="Unesi ključ kolone A" />
    <input type="text" id="keyB" placeholder="Unesi ključ kolone B" />
    <input type="text" id="keyC" placeholder="Unesi ključ kolone C" />
    <input type="text" id="keyD" placeholder="Unesi ključ kolone D" />
    <input type="text" id="finalKey" placeholder="Unesi konačno rešenje" />

    <div>
      <button class="check-button" onclick="checkColumn('A')">Proveri A</button>
      <button class="check-button" onclick="checkColumn('B')">Proveri B</button>
      <button class="check-button" onclick="checkColumn('C')">Proveri C</button>
      <button class="check-button" onclick="checkColumn('D')">Proveri D</button>
      <button class="check-button" onclick="checkFinalSolution()">Konačno rešenje</button>
    </div>

  <div id="toast-container"></div>
  <div id="timer">02:30</div>

<div id="endGameModal" class="modal">
  <div class="modal-content">
    <h2>Kraj igre!</h2>

    <h3>Rešenja</h3>
    <ul>
      <li><strong>A:</strong> <span id="solutionA"></span></li>
      <li><strong>B:</strong> <span id="solutionB"></span></li>
      <li><strong>C:</strong> <span id="solutionC"></span></li>
      <li><strong>D:</strong> <span id="solutionD"></span></li>
      <li><strong>Konačno:</strong> <span id="solutionFinal"></span></li>
    </ul>

    <p>Osvojio si <span id="finalScore"></span> bodova.</p>
    <button onclick="goToMainMenu()">Glavni meni</button>
  </div>
</div>


</div>

  <script>
    const games = [
      {
        words: {
          A1: "olovke", A2: "provodnik", A3: "nuklearne elektrane", A4: "elektrode", 
          B1: "1985", B2: "fudbalska lopta", B3: "60 atoma", B4: "nanotehnologija", 
          C1: "sitne amorfne čestice", C2: "modifikovani", C3: "prirodni", C4: "koks",
          D1: "nakit", D2: "noževi", D3: "reže staklo", D4: "veliki indeks prelamanja svjetlosti"
        },
        correctAnswers: {
          keyA: "Grafit",
          keyB: "Fuleren",
          keyC: "Ugalj",
          keyD: "Dijamant",
          finalKey: "Ugljenik"
        }
      },
      {
        words: {
          A1: "bockavog mirisa", A2: "otrovan", A3: "bijeljenje svile", A4: "suvo voće",
          B1: "molekulski", B2: "21% atmosfere", B3: "disanje", B4: "bezbojan",
          C1: "toksičan", C2: "crveno-smeđ", C3: "gušenje", C4: "kisele kiše",
          D1: "bunari", D2: "podrumi", D3: "fotosinteza", D4: "gazirana pića"
        },
        correctAnswers: {
          keyA: "SO2",
          keyB: ["O2", "kiseonik"],
          keyC: "NO2",
          keyD: "CO2",
          finalKey: "Dioksidi"
        }
      },
      {
        words: {
          A1: "69,8%", A2: "digestori", A3: "3.", A4: "pušiva",
          B1: "bezbojna", B2: "umjereno jaka", B3: "meta i piro", B4: "čvrsta",
          C1: "želudac", C2: "jaka", C3: "solna", C4: "bezbojna",
          D1: "uljasta", D2: "galice", D3: "98%", D4: "diprotonska"
        },
        correctAnswers: {
          keyA: "HNO3",
          keyB: "H3PO4",
          keyC: "HCl",
          keyD: "H2SO4",
          finalKey: "Kiseline"
        }
      },
      {
        words: {
          A1: "gas", A2: "Sunce i zvijezde", A3: "proton", A4: "lakši od vazduha",
          B1: "suze", B2: "29,4%", B3: "eksplozivi", B4: "vještačka đubriva",
          C1: "amfolit", C2: "pH neutralna", C3: "Tk = 100°C", C4: "najgušća 4°C",
          D1: "otrovan", D2: "gas", D3: "trula riba", D4: "ne rastvara se u H₂0"
        },
        correctAnswers: {
          keyA: ["H", "vodonik"],    // višestruka tačna rešenja
          keyB: ["NH3", "amonijak"],
          keyC: ["H20", "voda"],
          keyD: ["PH3", "fosfin"],
          finalKey: "Hidridi"
        }
      },
    ];

    let currentGameIndex = 0;
    let solvedKeys = { A: false, B: false, C: false, D: false };
    let gameEnded = false;
    let score = 0;
    let timerInterval;
    let timeLeft = 150; // 150 seconds

    function showToast(message, type = "success") {
      const toast = document.createElement("div");
      toast.classList.add("toast");
      if(type === "warning") toast.classList.add("toast-warning");
      else if(type === "error") toast.classList.add("toast-error");
      else toast.classList.add("toast-success");
      toast.textContent = message;

      const container = document.getElementById("toast-container");
      container.appendChild(toast);

      setTimeout(() => {
        toast.remove();
      }, 3000);
    }

    function updateScoreDisplay() {
      document.getElementById("scoreDisplay").textContent = score;
    }

    function loadGame(index) {
      solvedKeys = { A: false, B: false, C: false, D: false };
      gameEnded = false;
      score = 0;
      updateScoreDisplay();
      clearInterval(timerInterval);
      timeLeft = 150;
      updateTimerDisplay();
      startTimer();

      const tbody = document.querySelector("#table tbody");
      tbody.innerHTML = "";

      const game = games[index];

      // Pravimo 4 reda sa 4 kolone
      for(let i=1; i<=4; i++) {
        const row = document.createElement("tr");

        ['A','B','C','D'].forEach(col => {
          const td = document.createElement("td");
          td.id = col + i;
          td.textContent = game.words[col + i];
          td.style.color = "transparent"; // sakrij tekst
          td.style.position = "relative";

          // Dodajemo cover da se može kliknuti da otkrije
          const coverDiv = document.createElement("div");
          coverDiv.className = "cover";
          coverDiv.textContent = td.id;

          coverDiv.onclick = () => {
            if(gameEnded) return;
            coverDiv.style.display = "none";
            td.style.color = "white";
          };

          td.appendChild(coverDiv);
          row.appendChild(td);
        });
        tbody.appendChild(row);
      }

      // Reset input polja
      ['A','B','C','D'].forEach(col => {
        const input = document.getElementById("key"+col);
        input.value = "";
        input.style.backgroundColor = "";
      });
      const finalInput = document.getElementById("finalKey");
      finalInput.value = "";
      finalInput.style.backgroundColor = "";

      // Sakrij popup rešenja
      document.getElementById("miniSolutionPopup").style.display = "none";
    }

    function checkColumn(col) {
      if(gameEnded) return;

      // Proveri da li je otvoreno bar jedno polje u toj koloni
      let opened = false;
      for(let i=1; i<=4; i++) {
        const td = document.getElementById(col + i);
        if (!td.querySelector(".cover") || td.querySelector(".cover").style.display === "none") {
          opened = true;
          break;
        }
      }

      if(!opened) {
        showToast(`Otvorite bar jedno polje u koloni ${col}.`, "warning");
        return;
      }

      const input = document.getElementById("key"+col);
      const value = input.value.trim().toLowerCase();
      const correct = games[currentGameIndex].correctAnswers["key"+col];
let isCorrect = false;

if (Array.isArray(correct)) {
  isCorrect = correct.some(ans => ans.toLowerCase() === value);
} else {
  isCorrect = (correct.toLowerCase() === value);
}


      if(isCorrect) {
        input.style.backgroundColor = "#2e7d32"; // zelena
        if(!solvedKeys[col]) {
          solvedKeys[col] = true;
          score += 10;
          updateScoreDisplay();
          showToast(`Tačno rešenje za kolonu ${col}! +10 bodova.`);
        }
      } else {
        input.style.backgroundColor = "#b71c1c"; // crvena
        showToast(`Pogrešno rešenje za kolonu ${col}.`, "error");
      }
    }

    function checkFinalSolution() {
      if(gameEnded) return;

      const input = document.getElementById("finalKey");
      const value = input.value.trim().toLowerCase();
      const correct = games[currentGameIndex].correctAnswers.finalKey.toLowerCase();

      if(value === correct) {
        input.style.backgroundColor = "#2e7d32";
        // Za svaku nerešenu kolonu daj po 10 bodova kao da je rešena
        ['A','B','C','D'].forEach(col => {
          if(!solvedKeys[col]) {
            solvedKeys[col] = true;
            score += 10;
          }
        });

        score += 30; // +30 za konačno rešenje
        updateScoreDisplay();
        gameEnded = true;
        clearInterval(timerInterval);
        showToast("Čestitamo! Tačno konačno rešenje! +30 bodova i +10 po nerešenoj koloni.", "success");

        revealAllCells();
        showEndGameModal();


      } else {
        input.style.backgroundColor = "#b71c1c";
        showToast("Pogrešno konačno rešenje.", "error");
      }
    }

    function revealAllCells() {
      ['A','B','C','D'].forEach(col => {
        for(let i=1; i<=4; i++) {
          const td = document.getElementById(col + i);
          const cover = td.querySelector(".cover");
          if(cover) cover.style.display = "none";
          td.style.color = "white";
        }
      });
    }

    function showSolutionsPopup() {
      const popup = document.getElementById("miniSolutionPopup");
      const ans = games[currentGameIndex].correctAnswers;
      document.getElementById("solutionA").textContent = ans.keyA;
      document.getElementById("solutionB").textContent = ans.keyB;
      document.getElementById("solutionC").textContent = ans.keyC;
      document.getElementById("solutionD").textContent = ans.keyD;
      document.getElementById("solutionFinal").textContent = ans.finalKey;
      popup.style.display = "block";
    }

    function updateTimerDisplay() {
      const timer = document.getElementById("timer");
      let minutes = Math.floor(timeLeft / 60);
      let seconds = timeLeft % 60;
      timer.textContent = 
        (minutes < 10 ? "0" + minutes : minutes) + ":" + 
        (seconds < 10 ? "0" + seconds : seconds);
    }

    function startTimer() {
      timerInterval = setInterval(() => {
        if(timeLeft <= 0) {
          clearInterval(timerInterval);
          gameEnded = true;
          showToast("Isteklo je vreme! Otkrivaju se sva polja i rešenja.", "warning");
          revealAllCells();
          showEndGameModal();

          // Onemogući dalje pogađanje i otkrivanje
        } else {
          timeLeft--;
          updateTimerDisplay();
        }
      }, 1000);
    }

    // Nasumično izaberi igru pri učitavanju
    window.onload = () => {
      currentGameIndex = Math.floor(Math.random() * games.length);
      loadGame(currentGameIndex);
    };

    function showEndGameModal() {
  gameEnded = true;
  clearInterval(timerInterval);
  
  const solutions = {
    A: games[currentGameIndex].correctAnswers.keyA,
    B: games[currentGameIndex].correctAnswers.keyB,
    C: games[currentGameIndex].correctAnswers.keyC,
    D: games[currentGameIndex].correctAnswers.keyD,
    final: games[currentGameIndex].correctAnswers.finalKey
  };

  document.getElementById('finalScore').textContent = score;
  document.getElementById('solutionA').textContent = Array.isArray(solutions.A) ? solutions.A.join(", ") : solutions.A;
  document.getElementById('solutionB').textContent = Array.isArray(solutions.B) ? solutions.B.join(", ") : solutions.B;
  document.getElementById('solutionC').textContent = Array.isArray(solutions.C) ? solutions.C.join(", ") : solutions.C;
  document.getElementById('solutionD').textContent = Array.isArray(solutions.D) ? solutions.D.join(", ") : solutions.D;
  document.getElementById('solutionFinal').textContent = solutions.final;

  document.getElementById('endGameModal').style.display = 'block';
}


function goToMainMenu() {
  const modal = document.getElementById("endGameModal");
  modal.style.display = "none";
  const score = document.getElementById('scoreDisplay').textContent;
  localStorage.setItem('asocijacijeScore', score);
  window.location.href = "../igra.html"; // prilagodi putanju ako treba
}

  </script>
</body>
</html>